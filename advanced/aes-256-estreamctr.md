# AES-256-eSTREAMCTR

AES-256-eSTREAMCTR is AES-256 in counter mode with a 4-bytes counter as specified by the eSTREAM project.

## Usage

```c
int crypto_stream_aes256stream(unsigned char *out, unsigned long long outlen,
                            const unsigned char *n, const unsigned char *k);
```

The `crypto_stream_aes256estream()` function puts `outlen` pseudo random bytes into `out` using the secret key `k` (`crypto_stream_aes256estreamctr_KEYBYTES` bytes) and the nonce `n` (`crypto_stream_aes256estream_NONCEBYTES` bytes).

The output is generated by computing `AES256(n,k)` and by incrementing the 4 first bytes of the nonce until `outlen` bytes have been generated.

```c
int crypto_stream_aes256estreamctr_xor(unsigned char *out, const unsigned char *in,
                                unsigned long long inlen, const unsigned char *n,
                                const unsigned char *k);
```

The `crypto_stream_aes256estreamctr_xor()` function encrypts a message `in` whose length is `inlen` bytes using a secret key `k` (`crypto_stream_aes256estreamctr_KEYBYTES` bytes) and a nonce `n` (`crypto_stream_aes256estreamctr_NONCEBYTES` bytes).

The output is stored into `out`, which can overlap with `in` for in-place encryption.

In this mode, the same operation can be used both for encryption and decryption.

## Constants

- `crypto_stream_aes256estreamctr_KEYBYTES`
- `crypto_stream_aes256estreamctr_NONCEBYTES`

## Notes

`crypto_stream_aes256estreamctr()` doesn't have an internal counter: the nonce itself is incremented after each 16-bytes block. As a result, extreme care should be taken to avoid reusing a nonce with the same key.

Unless using AES is a requirement, you should consider  `crypto_stream()` (XSalsa20) instead.

`crypto_stream_aes256estreamctr_xor()` simply combines the message with the output of the stream cipher with the XOR operation, and does not add any authentication tag.

Unless this is exactly what you need, you should use `crypto_secretbox()` or `crypto_box()` instead.

These functions can generate/encrypt up to 2^32 - 1 bytes in a single call.
